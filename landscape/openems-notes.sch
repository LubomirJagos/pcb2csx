v 20130925 2
C 40000 40000 0 0 0 title-C.sym
B 52000 50100 500 4800 3 0 1 1 -1 100 0 -1 -1 -1 -1 -1
B 52100 50100 300 4800 3 0 0 0 -1 -1 1 -1 -1 -1 -1 -1
L 53300 55300 53100 54700 3 0 0 0 -1 -1
B 49500 52100 5500 700 3 0 1 0 -1 -1 0 -1 -1 -1 -1 -1
B 49500 53600 5500 600 3 0 1 0 -1 -1 0 -1 -1 -1 -1 -1
B 49500 53000 3600 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
L 49500 53400 49500 53600 3 0 0 0 -1 -1
L 55000 52800 55000 53600 3 0 0 0 -1 -1
L 49500 52800 49500 53000 3 0 0 0 -1 -1
B 51400 51500 3600 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
L 55000 51900 55000 52100 3 0 0 0 -1 -1
L 49500 51300 49500 52100 3 0 0 0 -1 -1
L 55000 51300 55000 51500 3 0 0 0 -1 -1
B 49500 49900 5500 600 3 0 0 0 -1 -1 0 -1 -1 -1 -1 -1
L 51400 49700 51800 50100 3 0 0 0 -1 -1
B 49500 50700 5500 600 3 0 1 0 -1 -1 0 -1 -1 -1 -1 -1
B 49500 54200 5500 200 3 0 0 0 -1 -1 0 -1 -1 -1 -1 -1
B 49500 50500 5500 200 3 0 0 0 -1 -1 0 -1 -1 -1 -1 -1
B 51400 50100 1700 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
B 51400 54400 1700 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
L 52500 51100 54000 49800 3 0 0 0 -1 -1
B 58500 50100 500 4800 3 0 1 1 -1 100 0 -1 -1 -1 -1 -1
B 58600 50100 300 4800 3 0 0 0 -1 -1 1 -1 -1 -1 -1 -1
L 59600 55200 59200 54800 3 0 0 0 -1 -1
B 56000 51900 5500 1100 3 0 1 0 -1 -1 0 -1 -1 -1 -1 -1
B 56000 53400 5500 1000 3 0 1 0 -1 -1 0 -1 -1 -1 -1 -1
B 56000 53000 3600 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
L 61500 53000 61500 53400 3 0 0 0 -1 -1
B 57900 51500 3600 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
L 56000 51500 56000 51900 3 0 0 0 -1 -1
B 56000 49900 5500 600 3 0 0 0 -1 -1 0 -1 -1 -1 -1 -1
L 57900 49700 58300 50100 3 0 0 0 -1 -1
B 56000 50500 5500 1000 3 0 1 0 -1 -1 0 -1 -1 -1 -1 -1
B 57900 50100 1700 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
B 57900 54400 1700 500 3 0 0 0 -1 -1 2 1 -1 100 -1 100
L 59000 51100 60600 49700 3 0 0 0 -1 -1
B 43000 41000 500 3100 3 0 1 1 -1 100 0 -1 -1 -1 -1 -1
B 43100 41000 300 3100 3 0 0 0 -1 -1 1 -1 -1 -1 -1 -1
L 44100 44500 43700 44100 3 0 0 0 -1 -1
B 40500 41000 5500 3100 3 0 1 0 -1 -1 0 -1 -1 -1 -1 -1
L 42200 40500 42700 41000 3 0 0 0 -1 -1
L 43500 41500 45100 40400 3 0 0 0 -1 -1
B 49500 42400 5500 1100 3 0 1 0 -1 -1 0 -1 -1 -1 -1 -1
B 52200 42400 300 1100 3 0 0 0 -1 -1 1 -1 -1 -1 -1 -1
B 52100 42400 500 1100 3 0 1 1 -1 100 0 -1 -1 -1 -1 -1
L 51100 54400 51100 55000 3 0 0 0 -1 -1
L 51100 55000 49500 55000 3 0 0 0 -1 -1
L 49500 55000 49500 54400 3 0 0 0 -1 -1
L 53400 54400 53400 55000 3 0 0 0 -1 -1
L 53400 55000 55000 55000 3 0 0 0 -1 -1
L 55000 55000 55000 54400 3 0 0 0 -1 -1
L 51400 55400 51700 55000 3 0 0 0 -1 -1
B 51400 54800 1700 100 3 0 0 0 -1 -1 3 1 4 200 -1 -1
L 52800 55100 52900 54900 3 0 0 0 -1 -1
T 40500 52300 9 10 1 0 0 0 5
The exporter should ask what the lowest priority it can use is and what the highest 
is. That way if you run out of room it can warn. I want to be able to set the pcb's 
base priority so that it can be super imposed in designs. I am not sure how well 
that will work but it is just a question of what number to use so we are not talking 
about a minor addition to the complexity we already have.
T 55400 40800 9 10 1 0 0 0 4
http://openems.de/index.php/Tutorial:_Importing_with_hyp2mat

3D copper used to model antennas
http://openems.de/index.php/Tutorial:_Simple_Patch_Antenna
T 49700 54600 9 10 1 0 0 0 1
Solder Mask
T 52100 52300 22 10 1 0 0 0 1
Air
T 53300 55300 9 10 1 0 0 0 1
Annular Ring
T 50100 53100 9 10 1 0 0 0 1
trace on inside layer
T 49700 52400 9 10 1 0 0 0 1
substrate
T 54100 52400 9 10 1 0 0 0 1
substrate
T 54100 53800 9 10 1 0 0 0 1
substrate
T 49700 53800 9 10 1 0 0 0 1
substrate
T 53600 53200 9 10 1 0 0 0 1
adheasive
T 50800 52800 9 10 1 0 0 0 1
adheasive
T 50800 53400 9 10 1 0 0 0 1
adheasive
T 40500 53500 9 10 1 0 0 0 15
we have to assume the board is planar otherwise impedances will be a nightmare.
yes in real life some vendors squish boards in ways that make the outline of 
internal copper layers embossed into all the layers over them. This type of 
manufacturing is impossibly bad for calculating impedances.

To save computational power in the E&M solver we should also ingore the tiny 
layer of adheasive under and over the copper layer. Making the stackup the same 
thickness but the substrate slightly thicker. So the stackup above on the left 
is altered into the one on the right. 

I am not sure if the annular ring actually has adheasive under it or if it is plated 
directly onto the board. This may vary with process. More research is needed.

If we do mechanical simulation or export later we should add in a feature to 
support export with adheasive because it adds required boundary conditions.
T 54600 51600 9 10 1 0 0 6 1
trace on inside layer
T 50900 51700 9 10 1 0 0 6 1
adheasive
T 53700 51300 9 10 1 0 0 6 1
adheasive
T 53700 51900 9 10 1 0 0 6 1
adheasive
T 54800 50300 9 10 1 0 180 0 1
Solder Mask
T 51400 49700 9 10 1 0 180 0 1
Annular Ring
T 50400 51100 9 10 1 0 180 0 1
substrate
T 54800 51100 9 10 1 0 180 0 1
substrate
T 50800 54200 9 10 1 0 0 0 1
adheasive
T 53000 54200 9 10 1 0 0 0 1
adheasive
T 50800 50500 9 10 1 0 0 0 1
adheasive
T 53800 50500 9 10 1 0 0 0 1
adheasive
T 53000 49600 9 10 1 0 0 0 1
copper plating on the hole
T 58600 52300 22 10 1 0 0 0 1
Air
T 59600 55200 9 10 1 0 0 0 1
Annular Ring
T 56500 53100 9 10 1 0 0 0 1
trace on inside layer
T 56200 52400 9 10 1 0 0 0 1
substrate
T 59900 52400 9 10 1 0 0 0 1
substrate
T 60000 53800 9 10 1 0 0 0 1
substrate
T 56200 53800 9 10 1 0 0 0 1
substrate
T 60100 53200 9 10 1 0 0 0 1
adheasive
T 61100 51600 9 10 1 0 0 6 1
trace on inside layer
T 57400 51700 9 10 1 0 0 6 1
adheasive
T 61300 50300 9 10 1 0 180 0 1
Solder Mask
T 57900 49700 9 10 1 0 180 0 1
Annular Ring
T 56900 51100 9 10 1 0 180 0 1
substrate
T 61000 51100 9 10 1 0 180 0 1
substrate
T 59600 49500 9 10 1 0 0 0 1
copper plating on the hole
T 47900 41300 9 10 1 0 0 0 1
Note: None of these drawings are to scale.
T 49400 55800 9 20 1 0 0 0 1
Worst case for PCB-RND storage.
T 56500 55800 9 20 1 0 0 0 1
Worst case for OpenEMS.
T 40500 50900 9 10 1 0 0 0 6
I am going to assume for simulation that the tiny amount of adheasive under and 
over the traces is not important to modeling in the E&M domain. If it was we would 
have to worry about minor variations in it's thickness and etc which would be brutal.

I am also going to assume that the adheasive is not exactly the same impedance as 
the substrate.
T 43100 42400 22 10 1 0 0 0 1
Air
T 44100 44500 9 10 1 0 0 0 1
Annular Ring
T 40700 42500 9 10 1 0 0 0 1
substrate
T 40700 43900 9 10 1 0 0 0 1
substrate
T 42200 40500 9 10 1 0 180 0 1
Annular Ring
T 45800 41200 9 10 1 0 180 0 1
substrate
T 44100 40200 9 10 1 0 0 0 1
copper plating on the hole
T 40500 44700 9 20 1 0 0 0 1
Multilayer accelerated with 2D mesh
T 45700 43400 9 10 1 0 180 0 1
substrate
T 52200 42900 22 10 1 0 0 0 1
Air
T 49700 42900 9 10 1 0 0 0 1
substrate
T 54100 42900 9 10 1 0 0 0 1
substrate
T 49500 44400 9 20 1 0 0 0 1
3D copper replaced with 2D mesh
T 51400 55400 9 10 1 0 0 6 1
Exposed Via
T 53500 54600 9 10 1 0 0 0 1
Solder Mask
T 52800 55100 9 10 1 0 0 6 1
ENIG Plating
L 59900 54400 59900 55000 3 0 0 0 -1 -1
L 59900 55000 61500 55000 3 0 0 0 -1 -1
L 61500 55000 61500 54400 3 0 0 0 -1 -1
L 57600 54400 57600 55000 3 0 0 0 -1 -1
L 57600 55000 56000 55000 3 0 0 0 -1 -1
L 56000 55000 56000 54400 3 0 0 0 -1 -1
T 60000 54600 9 10 1 0 0 0 1
Solder Mask
T 56200 54600 9 10 1 0 0 0 1
Solder Mask
T 51100 55200 9 10 1 0 0 6 1
Solder Mask Clearance
L 51100 55200 51300 54900 3 0 0 0 -1 -1
L 57900 55400 58200 55000 3 0 0 0 -1 -1
L 57600 55200 57800 54900 3 0 0 0 -1 -1
T 57900 55400 9 10 1 0 0 6 1
Exposed Via
T 57600 55200 9 10 1 0 0 6 1
Solder Mask Clearance
T 40500 47100 9 10 1 0 0 0 18
Every matterial has a priority, matterial and geometry in OpenEMS. We can only 
add matterials we can not subtract. However we can add non-conductive things 
at higher priority so that we create voids with pockets of air.

There is an added complexity in that we don't want to have to cut around traces 
and annular rings that are inside/adjacent to planes.

The following is how the priorities are to be used. The number after the item is the 
priority relative to the 0 point that users set. I want this feature because there might 
be a structure people want to layer this over/under after export.

holes, mask clearance & cutouts (air) 6
copper traces & copper planes with no clearance 5
substrate (adheasive) clearance 4
copper planes 3
adheasive 2
substrate 1
environment (air) 0 x and y set at time of export z left as a variable to the user
L 40500 43100 46000 43100 3 0 0 0 -1 -1
L 46000 42000 40500 42000 3 0 0 0 -1 -1
L 42400 42000 46000 42000 7 4 0 2 100 100
L 40500 43100 44100 43100 7 4 0 2 100 100
L 42400 41000 44100 41000 7 4 0 2 100 100
L 42400 44100 44100 44100 7 4 0 2 100 100
L 51400 42400 55000 42400 7 4 0 2 100 100
L 49500 43500 53100 43500 7 4 0 2 100 100
B 58500 43200 500 4800 3 0 1 1 -1 100 0 -1 -1 -1 -1 -1
B 58600 43200 300 4800 3 0 0 0 -1 -1 1 -1 -1 -1 -1 -1
L 59600 48400 59200 48000 3 0 0 0 -1 -1
B 56000 43600 5500 3900 3 0 1 0 -1 -1 0 -1 -1 -1 -1 -1
B 56000 46100 3600 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
B 57900 44600 3600 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
L 57900 42800 58300 43200 3 0 0 0 -1 -1
B 57900 43200 1700 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
B 57900 47500 1700 500 3 0 0 0 -1 -1 2 1 -1 100 -1 100
L 59000 44200 60600 43100 3 0 0 0 -1 -1
B 49500 46400 5500 1100 3 0 1 0 -1 -1 0 -1 -1 -1 -1 -1
B 49500 47500 3600 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
B 51400 46000 3600 400 3 0 0 0 -1 -1 2 1 -1 100 -1 100
B 52200 46000 300 1900 3 0 0 0 -1 -1 1 -1 -1 -1 -1 -1
B 52100 46000 500 1900 3 0 1 1 -1 100 0 -1 -1 -1 -1 -1
T 58600 45400 22 10 1 0 0 0 1
Air
T 59600 48400 9 10 1 0 0 0 1
Annular Ring
T 46200 42600 9 10 1 0 0 0 1
trace on inside layer as 2D mesh
T 56200 45500 9 10 1 0 0 0 1
substrate
T 56200 46900 9 10 1 0 0 0 1
substrate
T 61100 44700 9 10 1 0 0 6 1
trace on inside layer
T 57900 42800 9 10 1 0 180 0 1
Annular Ring
T 61300 44200 9 10 1 0 180 0 1
substrate
T 59700 42900 9 10 1 0 0 0 1
copper plating on the hole
T 56300 48900 9 20 1 0 0 0 1
Minimal Multilayer OpenEMS
T 61200 46400 9 10 1 0 180 0 1
substrate
T 52200 46900 22 10 1 0 0 0 1
Air
T 50100 47600 9 10 1 0 0 0 1
trace on inside layer
T 49700 46900 9 10 1 0 0 0 1
substrate
T 54100 46900 9 10 1 0 0 0 1
substrate
T 54700 46100 9 10 1 0 0 6 1
trace on inside layer
T 48400 48500 9 20 1 0 0 0 1
What we need in OpenEMS for minimal 2 layer.
T 40500 45600 9 10 1 0 0 0 6
In E&M solvers it is not uncommon to cheat a little and make the copper a 2D 
mesh applied over the substrate to save processing time. The problem is that 
openems does not currenly have any kind of 2D curved primitive. Emulating curves 
with a high order polygons would be unpleasant. We should IMHO wait until 
openems has 2D curve and arc primitives to invest time in acceleration using 2D 
mesh.
L 46200 42600 45300 42000 3 0 0 0 -1 -1
T 46200 43900 9 10 1 0 0 0 1
trace on inside layer as 2D mesh
L 46200 43900 43700 43100 3 0 0 0 -1 -1
T 49200 43800 9 10 1 0 0 0 1
trace as 2D mesh
L 50600 43800 51100 43500 3 0 0 0 -1 -1
T 53800 42000 9 10 1 0 0 0 1
trace as 2D mesh
L 53800 42000 53400 42400 3 0 0 0 -1 -1
T 58000 46200 9 10 1 0 0 6 1
trace on inside layer
T 56600 48700 9 10 1 0 0 0 1
This only works in with 3D representation of copper.
